{% load static %}
<footer class="py-4 bg-light mt-auto">
  <div class="container-fluid px-4">
      <div class="d-flex align-items-center justify-content-between small">
          <div class="text-muted">Copyright &copy; Your Website 2023</div>
          <div>
              <a href="#">Privacy Policy</a>
              &middot;
              <a href="#">Terms &amp; Conditions</a>
          </div>
      </div>
  </div>
</footer>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="{% static 'js/scripts.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script src="{% static 'assets/demo/chart-area-demo.js' %}"></script>
<script src="{% static 'assets/demo/chart-bar-demo.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
<script src="{% static 'js/datatables-simple-demo.js' %}"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
      // const showModal = `{{ show_modal|yesno:"true,false" }}`;
      if(`{{ show_modal }}`){
        const showModal = true
      }else{
        const showModal = false
      }
      if (showModal) {
          const modal = new bootstrap.Modal(document.getElementById("newTicketModal"));
          modal.show();
      }
  });
</script>

<script>
  // Sidebar Toggle
  document
    .getElementById("sidebarToggle")
    .addEventListener("click", function () {
      document.getElementById("sidebar").classList.toggle("sidebar-collapsed");
      document
        .querySelector(".main-content")
        .classList.toggle("sidebar-collapsed");
    });

  // Period Selection Buttons
  document.querySelectorAll(".btn-group .btn").forEach((button) => {
    button.addEventListener("click", function () {
      this.parentElement.querySelectorAll(".btn").forEach((btn) => {
        btn.classList.remove("btn-primary");
        btn.classList.add("btn-outline-secondary");
      });
      this.classList.remove("btn-outline-secondary");
      this.classList.add("btn-primary");
    });
  });

  // Initialize DataTable with enhanced features
  $(document).ready(function () {
    $("#activityTable").DataTable({
      pageLength: 5,
      lengthMenu: [
        [5, 10, 25, 50],
        [5, 10, 25, 50],
      ],
      order: [[2, "desc"]], // Sort by time column by default
      columnDefs: [
        {
          targets: -1,
          orderable: false, // Disable sorting for actions column
        },
      ],
      language: {
        search: "",
        searchPlaceholder: "Search records...",
        paginate: {
          previous: '<i class="fas fa-chevron-left"></i>',
          next: '<i class="fas fa-chevron-right"></i>',
        },
      },
      dom: '<"row"<"col-md-6"l><"col-md-6"f>>rtip',
    });
  });

  // Notification System
  document
    .querySelector('.nav-link[data-bs-toggle="dropdown"]')
    .addEventListener("click", function (e) {
      const badge = document.querySelector(".notification-badge");
      if (badge) {
        setTimeout(() => {
          badge.style.display = "none";
        }, 2000);
      }
    });

  // Welcome Alert Handler
  document
    .querySelector(".alert .btn-close")
    .addEventListener("click", function () {
      localStorage.setItem("welcomeDismissed", "true");
    });

  // Check Welcome Message Status
  if (localStorage.getItem("welcomeDismissed")) {
    document.querySelector(".alert").style.display = "none";
  }

  // Initialize all tooltips
  var tooltipTriggerList = [].slice.call(
    document.querySelectorAll('[data-bs-toggle="tooltip"]')
  );
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl);
  });

  // Add loading state to buttons
  document.querySelectorAll(".btn").forEach((button) => {
    button.addEventListener("click", function () {
      if (!this.classList.contains("dropdown-toggle")) {
        let originalContent = this.innerHTML;
        this.innerHTML =
          '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...';
        setTimeout(() => {
          this.innerHTML = originalContent;
        }, 1000);
      }
    });
  });
</script>
</body>
